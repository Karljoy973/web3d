<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<title>Projet Web 3D</title>
    <script type="text/javascript" src="../x3dom/x3dom.js"></script>
    <link rel="stylesheet" href="../x3dom/x3dom.css">
   <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.0.min.js"></script>
  <script type="text/javascript" src="visualizeTurntable.js"></script>
 

<style>
body {
	margin:0;
	padding:0;
}

#overlayHeader {
	position:absolute;
	z-index:5;
	top:50px;
	left:50px;
	padding:5px;
	color:#FFF;
	background-color:#000;
	opacity:0.5;
}

#nonInteractive {
	position:absolute;
	left:50px;
	bottom:50px;
	padding:20px;
	background-color:#EEE;
	border:1px solid silver;
	z-index:5;
	opacity:0.8;
}

#mainNav {
	position:absolute;
	right:50px;
	top:50px;
	width:300px;
	background-color:#EEE;
	border:1px solid silver;
	padding:20px;
	z-index:5;
	opacity:0.8;
}

.key {
	background-image: url(img/Keyboard_Button.png);
	width:30px;
	height:30px;
	padding:15px;
	font-size:17px;
	font-weight:bold;
	text-align:center;
	margin-right:10px;
}
</style>

<script>
var modes = [
             {
            	 "name":"Walk",
            	 "option":"walk",
            	 "shortcut":"w",
            	 "mouseLeft":"Move forward",
            	 "mouseRight":"Move backward",
             },
             {
	        	 "name":"Examine",
	        	 "option":"examine",
	        	 "shortcut":"e",
	        	 "mouseWheelScroll":"Zoom",
	        	 "mouseLeft":"rotate",
	        	 "mouseRight":"Zoom",
	        	 "mouseWheelPress":"Pan"
             },
             {
	        	 "name":"Fly",
	        	 "option":"fly",
	        	 "shortcut":"f",
            	 "mouseLeft":"Move forward",
            	 "mouseRight":"Move backward",
             },
             {
	        	 "name":"Helicopter",
	        	 "option":"helicopter",
	        	 "shortcut":"h",
            	 "mouseLeft":"Move forward",
            	 "buttons":
                	 [
                	 	{"key":"8", "desc":"Look down"},
                	 	{"key":"9", "desc":"Look up"},
                	 	{"key":"6", "desc":"Move higher"},
                	 	{"key":"7", "desc":"Move lower"}
                	 ]
             },
             {
	        	 "name":"Look at",
	        	 "option":"lookAt",
	        	 "shortcut":"l",
            	 "mouseLeft":"Move in",
            	 "mouseRight":"Move out",
             },
             {
	        	 "name":"Turntable",
	        	 "option":"turntable",
	        	 "shortcut":"n",
	        	 "mouseWheelScroll":"Zoom",
	        	 "mouseLeft":"rotate",
	        	 "mouseRight":"Zoom",
	        	 "mouseWheelPress":"Pan"
             },
             {
            	 "name":"Game", 
            	 "option":"game",
            	 "shortcut":"g", 
            	 "mouse":"Rotate view",
            	 "buttons":
            	 [
            	 	{"key":"&uarr;", "desc":"Move forward"},
            	 	{"key":"&darr;", "desc":"Move backwards"},
            	 	{"key":"&larr;", "desc":"Strafe left"},
            	 	{"key":"&rarr;", "desc":"Strafe right"}
            	 ]
             }
             ];
             
var canvas;             
var context;

function showModeDetails(mode)
{
	//Show shortcut
	$("#shortcut").html(mode.shortcut)
	
	//Show mouse operations
	$.each(["mouse", "mouseLeft", "mouseRight", "mouseWheelScroll", "mouseWheelPress"], function(index, mouse) {
		if(mode[mouse] != undefined)
		{
			$("#"+mouse).html(mode[mouse]);
			$("#"+mouse+"Row").show();
		}
		else
			$("#"+mouse+"Row").hide();
	});
	
	//Delete old keys and display new one if applicable
	$("#buttonTable").empty();     
	if(mode.buttons != undefined)
     {
    	 $.each(mode.buttons, function(buttonIndex, button) {
    		 $("#buttonTable").append("<tr><td><div class='key'>"+button.key + "</div></td><td>"+button.desc+"</td></tr>");
    		});
     }
	
	//Handle turntable specialities
	if(mode.name == "Turntable")
	{
		$("#turntableArea").show();
		refreshTurntableParams();
	}
	else
		$("#turntableArea").hide();
}


$(document).ready(function(){
	//Add all modes to dropdown field
	$.each(modes, function(index, value) {   
	     $('#modeSelect')
	          .append($('<option>', { value : value.option })
	          .text(value.name));
	     
	     if(index==0)
	    	 showModeDetails(value);
	});
	
	//Listen for changed modes...
	$("#modeSelect").on("change", function() {
		var currentMode = this.value;
		//...activate new mode...
		document.getElementById('navType').setAttribute("type", currentMode);

		//...and refresh hints
		$.each(modes, function(index, value) {  
			if(value.option == currentMode)
				showModeDetails(value);
		});
	});
	
	//Listen for turntable param changes...
	$('.turntableInput').on("change", function() {
		refreshTurntableParams();
	});
	
	//Listen for pressed shortcuts...
	$(document).on("keypress", function(event) {
		var key = String.fromCharCode(event.which);
		
		//...and refresh hints
		$.each(modes, function(index, value) {  
			if(value.shortcut == key)
			{
				$("#modeSelect option[value='"+value.option+"']").attr('selected',true);
				showModeDetails(value);
			}
		});
	});
	
	canvas = document.getElementById('turntableVis');
	context = canvas.getContext('2d');
	
	updateArc(0.2, 1.4);
});

</script>

</head>
<title>Projet Web 3D</title>
<script type="text/javascript" src="../x3dom/x3dom.js"></script>
<link rel="stylesheet" href="../x3dom/x3dom.css">
<!-- Inclure la bibliothèque X3DOM pour travailler avec X3D dans le DOM -->
<script src="https://www.x3dom.org/download/x3dom.js"></script>
<body>
<div id="overlayHeader">
<h1>Navigation mode explorer</h1>
</div>


<div id="mainNav">

	"Mode:" <select id="modeSelect"><option value="walk">Walk</option><option value="examine">Examine</option><option value="fly">Fly</option><option value="helicopter">Helicopter</option><option value="lookAt">Look at</option><option value="turntable">Turntable</option><option value="game">Game</option></select> Shortcut: <span id="shortcut">w</span>
	
	<hr>
	
	<div id="buttonArea">
		<table id="mouseTable">
		<tbody><tr id="mouseRow" style="display: none;"><td><img src="../img/Mouse.png"></td><td id="mouse"></td></tr>
		<tr id="mouseLeftRow"><td><img src="../img/Mouse_Left.png"></td><td id="mouseLeft">Move forward</td></tr>
		<tr id="mouseRightRow"><td><img src="../img/Mouse_Right.png"></td><td id="mouseRight">Move backward</td></tr>
		<tr id="mouseWheelScrollRow" style="display: none;"><td><img src="../img/Mouse_Wheel_Scroll.png"></td><td id="mouseWheelScroll"></td></tr>
		<tr id="mouseWheelPressRow" style="display: none;"><td><img src="../img/Mouse_Wheel_Press.png"></td><td id="mouseWheelPress"></td></tr>
		</tbody></table>
	
		<table id="buttonTable"></table>
	</div>
	
	<div id="turntableArea" style="display: none;">
		<hr>
		<b>Turntable mode settings</b><br>
		<table>
		<tbody><tr>
			<td><canvas id="turntableVis" width="80px" height="80px"></canvas></td>
			<td>
				Upper bound: <input type="number" class="turntableInput" id="upperInput" value="0.2" min="0" max="3.14" step="0.1"><br>
                Lower bound: <input type="number" class="turntableInput" id="lowerInput" value="1.4" min="0" max="3.14" step="0.1">
			</td>
		</tr>
		</tbody></table>
	</div>
</div>

<div id="nonInteractive">
	<h3>Non-interactive camera movement</h3>
	<table>
	<tbody><tr><td><div class="key">r</div></td><td><div class="key">a</div></td><td><div class="key">u</div></td></tr>
	<tr><td>Reset view</td><td>Show all</td><td>Upright view</td></tr>
	</tbody></table>
</div>

<x3d width="1080px" height="800px">
	<scene>
		<!-- Définir les informations de navigation -->
	<!-- 	<navigationInfo type="EXAMINE WALK" /> -->
		
		<!-- Ajouter un objet (dans cet exemple, un cube) -->
	<!---	<shape>
			<appearance>
				<material diffuseColor="1 0 0" />
			</appearance>
			<box size="2 2 2" />
		</shape> 
		----->
		<shape> 
			<appearance> 
			<material diffuseColor='1 0 0'></material> 
			</appearance> 
			<box></box> 
		</shape> 
	</scene>
</x3d>

</body>
</html>